<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="补完 REAPER 效率链的最后一环（一）ReaScript 基础"><meta name="keywords" content="REAPER"><meta name="author" content="溪夜,undefined"><meta name="copyright" content="溪夜"><title>补完 REAPER 效率链的最后一环（一）ReaScript 基础 | 溪夜的音频博客</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script><meta name="generator" content="Hexo 7.3.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ReaScript-%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">ReaScript 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E8%A1%A5%E5%AE%8C-REAPER-%E6%95%88%E7%8E%87%E9%93%BE%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E7%8E%AF"><span class="toc-number">1.1.</span> <span class="toc-text">1.1. 补完 REAPER 效率链的最后一环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%81%9A%E8%BF%99%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B"><span class="toc-number">1.2.</span> <span class="toc-text">1.2. 为什么要做这系列教程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-ReaScript-API-%E5%9F%BA%E7%A1%80"><span class="toc-number">1.3.</span> <span class="toc-text">1.3. ReaScript API 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-1-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.3.1. 简介</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-2-%E6%94%AF%E6%8C%81%E7%9A%84%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80"><span class="toc-number">1.4.</span> <span class="toc-text">1.3.2. 支持的编程语言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E7%AE%80%E5%8D%95%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.5.</span> <span class="toc-text">1.4. 简单实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lua-%E5%9F%BA%E7%A1%80"><span class="toc-number">2.</span> <span class="toc-text">Lua 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.1.</span> <span class="toc-text">2.1. 数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E9%80%BB%E8%BE%91%E5%88%A4%E6%96%AD"><span class="toc-number">2.2.</span> <span class="toc-text">2.2. 逻辑判断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5"><span class="toc-number">2.3.</span> <span class="toc-text">2.3. 循环语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5"><span class="toc-number">2.4.</span> <span class="toc-text">2.4. 循环控制语句</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%98%85%E8%AF%BB-ReaScript-%E6%96%87%E6%A1%A3%EF%BC%9F"><span class="toc-number">3.</span> <span class="toc-text">如何阅读 ReaScript 文档？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%8E%9F%E7%89%88%E6%96%87%E6%A1%A3%E4%B8%8E%E4%BC%98%E5%8C%96%E5%90%8E%E6%96%87%E6%A1%A3%E7%9A%84%E5%8F%96%E8%88%8D"><span class="toc-number">3.1.</span> <span class="toc-text">3.1. 原版文档与优化后文档的取舍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-%E5%8E%9F%E7%89%88%E6%96%87%E6%A1%A3"><span class="toc-number">3.1.1.</span> <span class="toc-text">3.1.1. 原版文档</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-X-Raym-%E7%89%88%E4%BC%98%E5%8C%96%E6%96%87%E6%A1%A3"><span class="toc-number">3.1.2.</span> <span class="toc-text">3.1.2. X-Raym 版优化文档</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-Mike-Lacey-%E7%89%88-Wiki-%E6%96%87%E6%A1%A3"><span class="toc-number">3.1.3.</span> <span class="toc-text">3.1.3. Mike Lacey 版 Wiki 文档</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%A6%82%E4%BD%95%E5%9C%A8%E6%96%87%E6%A1%A3%E4%B8%AD%E6%89%BE%E5%88%B0%E6%83%B3%E8%A6%81%E7%9A%84-API"><span class="toc-number">3.2.</span> <span class="toc-text">3.2. 如何在文档中找到想要的 API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E9%80%9A%E8%BF%87%E5%AE%9E%E4%BE%8B%E5%AD%A6%E4%B9%A0%E6%96%87%E6%A1%A3%E7%9A%84%E9%98%85%E8%AF%BB%E6%96%B9%E6%B3%95"><span class="toc-number">3.3.</span> <span class="toc-text">3.3. 通过实例学习文档的阅读方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%AE%9E%E4%BE%8B%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E5%B8%A6-UI-%E7%9A%84-ReaScript-%E8%84%9A%E6%9C%AC"><span class="toc-number">4.</span> <span class="toc-text">通过实例学习如何创建带 UI 的 ReaScript 脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%A6%82%E4%BD%95%E6%89%93%E5%BC%80-REAPER-%E4%B8%AD%E7%9A%84%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%EF%BC%9F"><span class="toc-number">4.1.</span> <span class="toc-text">4.1. 如何打开 REAPER 中的开发环境？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E6%8A%BD%E8%B1%A1%E5%87%BA%E5%8A%9F%E8%83%BD%E9%80%BB%E8%BE%91"><span class="toc-number">4.2.</span> <span class="toc-text">4.2. 抽象出功能逻辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E9%80%89%E6%8B%A9-API"><span class="toc-number">4.3.</span> <span class="toc-text">4.3. 选择 API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E7%BC%96%E5%86%99%E5%8A%9F%E8%83%BD%E4%BB%A3%E7%A0%81"><span class="toc-number">4.4.</span> <span class="toc-text">4.4. 编写功能代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-%E7%BB%98%E5%88%B6-GUI"><span class="toc-number">4.5.</span> <span class="toc-text">4.5. 绘制 GUI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-%E8%BF%9E%E6%8E%A5-GUI-%E4%B8%8E%E5%8A%9F%E8%83%BD%E4%BB%A3%E7%A0%81"><span class="toc-number">4.6.</span> <span class="toc-text">4.6. 连接 GUI 与功能代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-%E5%AE%8C%E6%88%90%E6%95%88%E6%9E%9C"><span class="toc-number">4.7.</span> <span class="toc-text">4.7. 完成效果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E4%B8%BE%E4%B8%80%E5%8F%8D%E4%B8%89%E5%AD%A6%E4%BC%9A%E6%9B%B4%E5%A4%9A%E8%84%9A%E6%9C%AC"><span class="toc-number">5.</span> <span class="toc-text">通过举一反三学会更多脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%B4%E8%B0%A2"><span class="toc-number">6.</span> <span class="toc-text">致谢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E4%B8%8B%E6%9D%A5%E8%AE%B2%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">7.</span> <span class="toc-text">接下来讲什么？</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">溪夜</div><div class="author-info__description text-center">一个 Technical Sound Designer / Sound Engineer / iOS Music Maker / Gearslut / Synth-Lover / Extreme Metal Vocalist / Guitarist / LLer / 惠海人 / 明日香老缠粉 / 音频行业恐怖分子</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">25</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">9</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">1</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友情链接</div><a class="author-info-links__name text-center" href="https://sololand.moe/" target="_blank">zpan的独奏乡</a><a class="author-info-links__name text-center" href="http://jazzlost.me/" target="_blank">李AA的博客</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.cnn.com/cnnnext/dam/assets/170407220916-04-iconic-mountains-matterhorn-restricted.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">溪夜的音频博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a><a class="site-page" href="/">Home</a><a class="site-page" href="/about">About Me</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a></span></div><div id="post-info"><div id="post-title">补完 REAPER 效率链的最后一环（一）ReaScript 基础</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-09-20</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">7.5k</span><span class="post-meta__separator">|</span><span>阅读时长: 27 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>大家好，我是溪夜。<br>REAPER 的强大无需多言。无论是 Action List 中琳琅满目的功能，亦或是 SWS Extension 和 ReaPack 带来的超强拓展，对每一个从传统 DAW 转过来的人都是极大的惊喜。<strong>毕竟 REAPER 最大的问题不是它能不能做到，而是你能不能想到。</strong>通常你能想到的问题和需求，都能通过在 REAPER 找到对应功能或脚本来搞定。<br><strong>但你是否好奇过 ReaPack 中那些脚本是怎么写出来的？你是否曾不满于现有的脚本的功能？</strong>这篇文章会帮助你解决这些疑惑，让我们彻底从头学习一下脚本的构建。</p>
<blockquote>
<p>本系列文章阅读需要的前置知识：</p>
<ul>
<li>有一定的英文基础，能够看懂 ReaScript 文档。最好有在 Cockos 论坛上搜索答案的能力。</li>
<li>了解过一门编程语言，有 Lua 基础最好。零基础也不怕，我会快速讲解一下 Lua 语法基础，非常简单。</li>
<li>对 REAPER 的功能比较了解，并已安装好 ReaPack。</li>
<li>掌握基本的 GUI 设计知识。</li>
</ul>
</blockquote>
<p>本文目录：</p>
<p>[toc]</p>
<h2 id="ReaScript-基础"><a href="#ReaScript-基础" class="headerlink" title="ReaScript 基础"></a>ReaScript 基础</h2><h3 id="1-1-补完-REAPER-效率链的最后一环"><a href="#1-1-补完-REAPER-效率链的最后一环" class="headerlink" title="1.1. 补完 REAPER 效率链的最后一环"></a>1.1. 补完 REAPER 效率链的最后一环</h3><p><strong>既然 REAPER 现有的东西已经这么厉害，为什么还要学 ReaScript 来自己写脚本？</strong><br>其实我们很容易发现，在声音设计或者音乐混音的工作中，<strong>很多需求都需要去定制才能做到</strong>，只用现有的脚本和功能是远远不够的。<br>举个例子，在 WAAPI 中有通过“制表符分割文件”进行自动导入音频文件的 API，即通过文本文件中定义的文件名、文件路径、属性等信息，自动导入并创建 Wwise 中的对象。但显然，REAPER 本身没有功能能做到从文件中读取信息并创建轨道且设置相关属性的功能。<br><strong>我们先用脚本小白的思维做一下探索</strong>，试着搜索一下有没有人已经做过类似的脚本。</p>
<ul>
<li>X-Raym 曾做过一个 <code>Import tracks from file</code> 脚本，可以快速的从 txt 或 csv 文件中创建音轨，但这个脚本做不到同时导入音频文件，只能快速创建音轨标题。</li>
<li>继续搜索，会发现他还做过一个付费的脚本 <code>Import items and regions from CSV</code>，功能虽比上一个稍多一点，但也不做不到我们的要求。</li>
</ul>
<p><strong>当然，在这篇文章里我不会讨论搜索技巧，或者如何撞大运找到现成的轮子。</strong><br><strong>我们真正要思考的问题是：</strong></p>
<ol>
<li>现在有个现成的轮子无法满足我们，怎么在它的基础上增改代码以符合我们的需求？</li>
<li>如果真没现成的脚本，该如何从零搭个新的？</li>
</ol>
<p><strong>如果你对技术尚存追求，那么学习 ReaScript 就是你必修的一门 REAPER 功课。</strong></p>
<h3 id="1-2-为什么要做这系列教程"><a href="#1-2-为什么要做这系列教程" class="headerlink" title="1.2. 为什么要做这系列教程"></a>1.2. 为什么要做这系列教程</h3><p>在创作这篇文章之前，国内领域也有一些朋友做了关于 ReaScript 的教程。<strong>比如 Moy 老师曾做过几篇关于 ReaScript 的实例教学</strong>，在知乎、音频应用、声音设计论坛等社区中也有些朋友在分享自己所做的脚本。<br>之所以我还要做一系列新的教程，原因有几点：</p>
<ol>
<li><strong>这个领域应该有一套更友好且更系统的教程</strong>，尤其要解答初学者在学习与使用 ReaScript 时的一些疑惑。</li>
<li>补充一些重要的内容，比如<strong>阅读文档的方法、给脚本设计 UI、在 REAPER 外调用 ReaScript 等。</strong></li>
<li>奔着开源精神触发，<strong>我希望更多有创意的脚本被大家开发出来。</strong></li>
</ol>
<p>下面就让我们一起先从 ReaScript 基础开始。</p>
<h3 id="1-3-ReaScript-API-基础"><a href="#1-3-ReaScript-API-基础" class="headerlink" title="1.3. ReaScript API 基础"></a>1.3. ReaScript API 基础</h3><h4 id="1-3-1-简介"><a href="#1-3-1-简介" class="headerlink" title="1.3.1. 简介"></a>1.3.1. 简介</h4><p>ReaScript API 是 REAPER 中重要的功能补充，与 Action 的不同之处就是它更贴近底层。我们都知道，REAPER 的 Action 能瞬间完成一个具体的功能（这个功能实际上帮你一下子完成了多个功能步骤)。但在 API 中想是做到同样的效果，就要把这个功能拆解成<strong>细小步骤</strong>，并用代码实现每一步的操作后才能做到同样的事情。<br><strong>Action 和在 ReaPack 中下载的诸多脚本其实一样，本质上是一种对底层多步骤操作的封装。</strong>而我们“做脚本”这件事，就是重新封装属于我们自己的“功能想象”。<br>拿 <code>Item edit: Move position of item under mouse to edit cursor</code> 举例，当我们执行这个 Action，当前鼠标光标下的对象会直接移动到光标处，听起来似乎非常简单。<br><strong>但如果用脚本来实现，步骤就多了很多：</strong></p>
<ol>
<li>获取鼠标下的对象：<code>BR_GetMouseCursorContext_Item()</code></li>
<li>获取游标的位置：<code>GetCursorPosition()</code></li>
<li>把对象的左边缘移动到游标的位置：<code>SetMediaItemInfo_Value()</code></li>
</ol>
<p>可以看到，除了把这个 Action 拆成了三个步骤外，我还找到了对应的 API 功能，这是复刻这条 Action 的基础。<br>REAPER 脚本的原理，即<strong>要想办法把我们的需求不断拆解，最终达到每个细节步骤都能通过调用一条 API 完成（如上例所示）。</strong>最后再通过基本的程序结构为它们设计执行逻辑，就能得到具有功能性的脚本。</p>
<ul>
<li><strong>把大象放进冰箱需要三步，打开冰箱门，把大象放进去，把冰箱门关上。</strong></li>
</ul>
<p>很多人都听说过小品中的这句话，但可思考过它背后的逻辑？<strong>拆解一个看似想当然的行为，这也是脚本开发的基础逻辑。</strong><br>而事实上把大象放进冰箱里还有着很多前提：<br>冰箱（容器）能否装载这么大的动物（数据类型），这个大象是否需要麻醉（类似 Profiler 中时间点的概念），通过什么工具运载大象到冰箱里（中间变量，甚至压缩算法）……<br><strong>让读者有能力进行功能的拆解和找到对应的 API，这也是本系列文章所讲解的一个重点。</strong>我认如果你学明白这部分，剩下的组装程序与 GUI 开发其实也就没什么难度了。<br>REAPER 脚本开发的另一个优势在于已它已内置了编码工具，不需要配置开发环境就能直接在内部进行脚本编程（此处不包括 Python）。甚至，无需 Juce 这种框架就能进行插件（JSFX）的开发。<br><img src="/images/reaper%E5%BC%80%E5%8F%91.png" alt="REAPER开发"></p>
<p>上图为我在脚本开发时的截图。虽图片被压缩，但仍容易看出，凭 REAPER 和 ReaPack 提供的开发工具，我们在 REAPER 中能获得从代码到 GUI 构建器一整套开发工作流。</p>
<h3 id="1-3-2-支持的编程语言"><a href="#1-3-2-支持的编程语言" class="headerlink" title="1.3.2. 支持的编程语言"></a>1.3.2. 支持的编程语言</h3><p>ReaScript 支持三种脚本编程语言，分别是 REAPER 自有的 EEL、Lua 和 Python（2.7-3.X）。其中 EEL 不仅可用于 ReaScript 的开发，亦可用于 JS 插件的开发。（ReaScript 对于 C/C++ 也有支持，但在本文暂不予讨论）。<br><strong>本文会着重讨论 ReaScript 通过 Lua 的实现。</strong>因为本人目前不熟悉 EEL，且 Python 在 REAPER 内的性能没有 EEL 或 Lua 好，亦无法实现 UI 或图形显示。<br>不过对于在 REAPER 外调用 API 我们会在下一篇有额外的讨论，在那里我们会用到 Python。</p>
<h3 id="1-4-简单实例"><a href="#1-4-简单实例" class="headerlink" title="1.4. 简单实例"></a>1.4. 简单实例</h3><p>既然是实例，我希望更有针对性。作为国际惯例，先从 Hello REAPER 开始。<br>这种基本的字符串输出实例的意义就是一条，代表你跑通了当前的开发环境。<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reaper.ShowConsoleMsg(<span class="string">&quot;Hello REAPER!&quot;</span>)</span><br></pre></td></tr></table></figure><br><img src="/images/Hello%20Reaper.png" alt="Hello REAPER"><br>执行这句代码可看到如上的返回结果。</p>
<p>之后回过来看一下开头提到的那条 Action：<code>Item edit: Move position of item under mouse to edit cursor</code>。我们通过 ReaScript 复刻一下它的功能，这种学习方式会让你对它的功能实现过程认识的更加深刻。<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">item = reaper.BR_GetMouseCursorContext_Item()</span><br><span class="line">cursor_pos = reaper.GetCursorPosition()</span><br><span class="line">reaper.SetMediaItemInfo_Value(item, <span class="string">&quot;D_POSITION&quot;</span>, cursor_pos)</span><br></pre></td></tr></table></figure><br>执行上面的脚本后，我们发现鼠标下面的对象如期望的移动到了光标处。<br>严格来说，这个脚本还需要加上 Undo_BeginBlock() 和 Undo_EndBlock() 以满足 REAPER 的撤销记录功能。否则执行脚本后会无法撤销，这些暂且不加以讨论。<br><strong>可能你还看不懂这部分代码，甚至不知道怎么执行它，不要担心，看完这篇文章后你就能轻松写出这样的脚本。</strong></p>
<h2 id="Lua-基础"><a href="#Lua-基础" class="headerlink" title="Lua 基础"></a>Lua 基础</h2><p><strong>为了照顾没接触过 Lua 的朋友，下面我们简单讲解一下它的基本语法。</strong>如果已有 Lua 基础，请直接跳到本文第三部分“如何阅读 ReaScript 文档”。<br>Lua 作为一门上手容易的的脚本语言，无论是在 ReaScript 开发还是在使用 xLua 这种热更新框架时都会用到。与 Python 类似，Lua 的语法并不复杂，学习成本很低。</p>
<h3 id="2-1-数据类型"><a href="#2-1-数据类型" class="headerlink" title="2.1. 数据类型"></a>2.1. 数据类型</h3><p>nil：表示没有任何有效值。<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 打印尚未赋值的变量 a，可得到返回值 nil</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- result: </span></span><br><span class="line"><span class="literal">nil</span></span><br></pre></td></tr></table></figure><br>boolean：在 Lua 中布尔值的假对应的只有 false 和 nil，其余所有的均为真（包括数字0）.<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="literal">nil</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;0 = true&quot;</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;0 = false&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- result:</span></span><br><span class="line">boolean</span><br><span class="line"><span class="number">0</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure><br>number：数字类型，在 Lua 5.2 之前均为双精度浮点型，在之后分为64位整型 integer 和双精度浮点型 float，但它们也属于 number 类型。<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 分别输出不带小数点和带小数点的数字类型</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="number">3.0</span>))</span><br><span class="line"><span class="comment">-- 通过 math 模块判断数字是整型或浮点类型</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">type</span>(<span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">type</span>(<span class="number">3.0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- result:</span></span><br><span class="line">number</span><br><span class="line">number</span><br><span class="line">integer</span><br><span class="line">float</span><br></pre></td></tr></table></figure><br>string：字符串，单引号或双引号均可定义字符串内容。<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string1 = <span class="string">&quot;string1&quot;</span></span><br><span class="line">string2 = <span class="string">&#x27;string2&#x27;</span></span><br></pre></td></tr></table></figure><br>table：Lua 中的表与 Python 中的列表不同，table 还可以通过添加索引（数字或字符串）作为字典（关联数组）来使用.<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建空 table，</span></span><br><span class="line">tbl1 = &#123;&#125;</span><br><span class="line"><span class="comment">-- 直接初始化 table 并打印其中的元素，打印 table 指定索引之间的字符串。注意：Lua 的初始索引以1开始，而不是0。</span></span><br><span class="line">tbl2 = &#123;<span class="string">&quot;obj1&quot;</span>, <span class="string">&quot;obj2&quot;</span>, <span class="string">&quot;obj3&quot;</span>, <span class="string">&quot;obj4&quot;</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(tbl2[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">concat</span>(tbl2, <span class="string">&quot;,&quot;</span>, <span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建空 table，并指派一个键值对 a: 20</span></span><br><span class="line">associative_arrays = &#123;&#125;</span><br><span class="line">key = <span class="string">&quot;a&quot;</span></span><br><span class="line">associative_arrays[key] = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 打印 associative_arrays 中键值对，并分别通过变量 key 与字符串 a 来索引 table</span></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(associative_arrays) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(k .. <span class="string">&quot; : &quot;</span> .. v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">print</span>(associative_arrays[key])</span><br><span class="line"><span class="built_in">print</span>(associative_arrays.a)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- result:</span></span><br><span class="line">obj1</span><br><span class="line">obj2,obj3</span><br><span class="line">a : <span class="number">20</span></span><br><span class="line"><span class="number">20</span></span><br><span class="line"><span class="number">20</span></span><br></pre></td></tr></table></figure><br>function：函数。<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 不含参数的函数：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add_numbers</span><span class="params">()</span></span></span><br><span class="line">    a = <span class="number">1</span></span><br><span class="line">    b = <span class="number">2</span></span><br><span class="line">    c = a + b</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 含参数的函数：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add_numbers</span><span class="params">(a, b)</span></span></span><br><span class="line">    c = a + b</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br>thread：线程，表示执行的独立线路，用于执行协同程序。<br>userdata：用户自定义数据类型，可将 C/C++ 的任意数据类型的数据存储到 Lua 变量中调用。</p>
<h3 id="2-2-逻辑判断"><a href="#2-2-逻辑判断" class="headerlink" title="2.2. 逻辑判断"></a>2.2. 逻辑判断</h3><p>if 语句：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a &lt; <span class="number">20</span>)</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;a 小于20&quot;</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br>if…else 语句：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a &lt; <span class="number">20</span>)</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;a 小于20&quot;</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;a 大于20&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br>if…elseif…else 语句：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a == <span class="number">10</span>)</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;a 的值为10&quot;</span>)</span><br><span class="line"><span class="keyword">elseif</span>(a == <span class="number">20</span>)</span><br><span class="line"><span class="keyword">then</span>  </span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;a 的值为20&quot;</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;没有匹配 a 的值&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="2-3-循环语句"><a href="#2-3-循环语句" class="headerlink" title="2.3. 循环语句"></a>2.3. 循环语句</h3><p>while 循环：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 当 a 小于20时持续执行循环体</span></span><br><span class="line"><span class="keyword">while</span>(a &lt; <span class="number">20</span>)</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;a 的值为:&quot;</span>, a)</span><br><span class="line">   a = a + <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br>数值 for 循环：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 没设置递增步长的 for 循环，每执行一次执行体后以1为单位递增 i</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>,<span class="number">5</span> <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 以-1为递增步长的 for 循环，每执行一次执行体后以1为单位递增 -1</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">10</span>,<span class="number">1</span>,<span class="number">-1</span> <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br>泛型 for 循环：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = &#123;<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 通过迭代器函数 ipairs 来遍历所有值</span></span><br><span class="line"><span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">ipairs</span>(a) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(i, v)</span><br><span class="line"><span class="keyword">end</span> </span><br></pre></td></tr></table></figure><br>repeat…until：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 持续执行循环体，直到 a 大于20时跳出循环</span></span><br><span class="line"><span class="keyword">repeat</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;a 的值是：&quot;</span>, a)</span><br><span class="line">   a = a + <span class="number">1</span></span><br><span class="line"><span class="keyword">until</span>(a &gt; <span class="number">20</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="2-4-循环控制语句"><a href="#2-4-循环控制语句" class="headerlink" title="2.4. 循环控制语句"></a>2.4. 循环控制语句</h3><p>break 语句：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 当 i 小于3时跳出循环体</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">10</span>,<span class="number">1</span>,<span class="number">-1</span> <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">if</span> (i &lt; <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br>goto 语句：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设定 label</span></span><br><span class="line">::label:: <span class="built_in">print</span>(<span class="string">&quot;a = &quot;</span>, a)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 当 a 小于3的时候跳转到 label</span></span><br><span class="line"><span class="keyword">if</span> a &lt; <span class="number">3</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">goto</span> label </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h2 id="如何阅读-ReaScript-文档？"><a href="#如何阅读-ReaScript-文档？" class="headerlink" title="如何阅读 ReaScript 文档？"></a>如何阅读 ReaScript 文档？</h2><h3 id="3-1-原版文档与优化后文档的取舍"><a href="#3-1-原版文档与优化后文档的取舍" class="headerlink" title="3.1. 原版文档与优化后文档的取舍"></a>3.1. 原版文档与优化后文档的取舍</h3><h4 id="3-1-1-原版文档"><a href="#3-1-1-原版文档" class="headerlink" title="3.1.1. 原版文档"></a>3.1.1. 原版文档</h4><p>两种打开方法：</p>
<ol>
<li>打开 Help 菜单，点击 ReaScript documentation</li>
<li>直接访问 <a href="https://www.reaper.fm/sdk/reascript/reascripthelp.html">https://www.reaper.fm/sdk/reascript/reascripthelp.html</a></li>
</ol>
<p>对于原版文档，建议大家采用第一种方法。官网的在线的 API 版本还停留在 REAPER 5 时代，时效性很差。<br><img src="/images/%E4%B8%91%E9%99%8B%E7%9A%84%20API%20%E6%96%87%E6%A1%A3.png" alt="丑陋的 API 文档"><br>丑陋的原版文档</p>
<p>不难发现，ReaScript API 原版文档过于简陋，排版很难看，不便于使用。<strong>但原版文档，尤其是本机自带的原版文档具有最佳的时效性。</strong></p>
<h4 id="3-1-2-X-Raym-版优化文档"><a href="#3-1-2-X-Raym-版优化文档" class="headerlink" title="3.1.2. X-Raym 版优化文档"></a>3.1.2. X-Raym 版优化文档</h4><p>为了解决原版文档过于简陋的问题，X-Raym 做了一个优化版本的文档：<br><a href="https://www.extremraym.com/cloud/reascript-doc/">https://www.extremraym.com/cloud/reascript-doc/</a><br><img src="/images/x-raym%E7%89%88%20%E6%96%87%E6%A1%A3.png" alt="x-raym版 文档"></p>
<p>X-Raym 整理的这版文档的排版与格式都是上等，<strong>并人性化的在左侧放置了搜索框。</strong>这也是我主力推荐的版本。唯一的小缺点是更新稍有不及时，比如在本文发布的时间下 X-Raym 的这版文档停留在了5月3日。<br>如果有对文档时效性的需求（一般来说看这版足矣），还是请以官方文档为准。</p>
<h4 id="3-1-3-Mike-Lacey-版-Wiki-文档"><a href="#3-1-3-Mike-Lacey-版-Wiki-文档" class="headerlink" title="3.1.3. Mike Lacey 版 Wiki 文档"></a>3.1.3. Mike Lacey 版 Wiki 文档</h4><p>Mike Lacey 在09年创建了 REAPER Wiki，其中也包括 ReaScript Wiki，但很久未更新。除非有朋友对 Wiki 有执念，否则不推荐这版本。<br>地址：<a href="https://wiki.cockos.com/wiki/index.php/ReaScript">https://wiki.cockos.com/wiki/index.php/ReaScript</a><br><img src="/images/%E8%8D%92%E5%BA%9F%E7%89%88%E6%96%87%E6%A1%A3.png" alt="荒废版文档"><br>许久不更新的 ReaScript Wiki</p>
<h3 id="3-2-如何在文档中找到想要的-API"><a href="#3-2-如何在文档中找到想要的-API" class="headerlink" title="3.2. 如何在文档中找到想要的 API"></a>3.2. 如何在文档中找到想要的 API</h3><p>ReaScript 的 API 数量庞大，算上扩展 API 近千个，显然是没有什么好方法去整理的。我曾试过通过思维导图进行分类，但因数量庞大，实在没有精力像 WAAPI 那样通过导图进行详细分类。<br>但是要知道，<strong>ReaScript 有些 API 可能你一辈子用不上，</strong>所以明确自己的目的，寻找自己需要的 API 才是对的，而不是被庞大的 API 列表所击打。<br><strong>一个简略且有效的文档查找步骤是：</strong></p>
<ol>
<li>在逻辑抽象阶段想明白自己要的功能是什么分类，并抽象出关键词，如<code>get</code>、<code>media</code>、<code>midi</code>、<code>takefx</code>等。</li>
<li>利用 X-Raym 版优化文档强大的搜索功能，通过组合词搜索找到目标 API。</li>
<li>在现有的脚本中查找功能相似的，学习它们的 API 调用。</li>
<li>善用 Google。</li>
</ol>
<h3 id="3-3-通过实例学习文档的阅读方法"><a href="#3-3-通过实例学习文档的阅读方法" class="headerlink" title="3.3. 通过实例学习文档的阅读方法"></a>3.3. 通过实例学习文档的阅读方法</h3><p>相信大家也发现 ReaScript 的脚本出了名的简略，我以富有代表性的 API 作为例子分析一下，先看 <code>GetTrackName</code> 这条 API 在文档中的介绍：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">boolean retval, <span class="built_in">string</span> buf = reaper.GetTrackName(MediaTrack track)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Returns &quot;MASTER&quot; for master track, &quot;Track N&quot; if track has no name.</span></span><br></pre></td></tr></table></figure><br>根据文档我们可知，它的返回值有两个，一个是布尔类型的取回结果，一个是字符串类型的轨道名。文档中已注明特例的返回值，对于 master track 会返回 <code>MASTER</code>，如果轨道没有名字则会返回 <code>Track N</code>，看到这里似乎一切还很简单。<br><strong>但是请注意，它的参数是 <code>MediaTrack track</code>，如果你想当然的用鼠标选择一条轨道后就直接执行这条 API，并不会得到想要的轨道名，这是为什么？</strong><br>如果还记得“大象放进冰箱需要几步”就会明白，目前步骤细分的还不够。<strong>实际上这个 API 需要的参数是 MediaTrack 类型的轨道对象。</strong>所以如果想流畅使用 <code>GetTrackName</code>，先要想办法弄到这个 MediaTrack 类型的轨道对象。<br>通过在文档中搜索 MediaTrack，我们定位到另外一条 API：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MediaTrack reaper.GetTrack(ReaProject proj, integer trackidx)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- get a track from a project by track count (zero-based) (proj=0 for active project)</span></span><br></pre></td></tr></table></figure><br>终于，这条 API 的返回值是我们需要的 MediaTrack 对象，而它需要的输入值分别是工程编号及轨道编号。<br>我们用以下代码进行测试：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"