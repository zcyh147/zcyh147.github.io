<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="人人都能用 WAAPI（二）wwise.core 分支"><meta name="keywords" content=""><meta name="author" content="溪夜,undefined"><meta name="copyright" content="溪夜"><title>人人都能用 WAAPI（二）wwise.core 分支 | 溪夜的音频博客</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#wwise-core-概览"><span class="toc-number">1.</span> <span class="toc-text">wwise.core 概览</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#audio（导入音频并创建对象）"><span class="toc-number">2.</span> <span class="toc-text">audio（导入音频并创建对象）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能简介"><span class="toc-number">2.1.</span> <span class="toc-text">功能简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景"><span class="toc-number">2.2.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#audioSourcePeaks（音频源峰值获取）"><span class="toc-number">3.</span> <span class="toc-text">audioSourcePeaks（音频源峰值获取）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能介绍"><span class="toc-number">3.1.</span> <span class="toc-text">功能介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景-1"><span class="toc-number">3.2.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#object（对象操作）"><span class="toc-number">4.</span> <span class="toc-text">object（对象操作）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能介绍-1"><span class="toc-number">4.1.</span> <span class="toc-text">功能介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#create-copy-delete-move（对象基本操作）"><span class="toc-number">4.1.1.</span> <span class="toc-text">create, copy, delete, move（对象基本操作）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#setReference-setRandomizer-setAttenuationCurve-setName-setNotes-setProperty（设置对象的各种属性）"><span class="toc-number">4.1.2.</span> <span class="toc-text">setReference, setRandomizer, setAttenuationCurve, setName, setNotes, setProperty（设置对象的各种属性）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#get-getTypes-getPropertyInfo-getAttenuationCurve-getPropertyAndReferenceNames（获取对象的各种属性）"><span class="toc-number">4.1.3.</span> <span class="toc-text">get, getTypes, getPropertyInfo, getAttenuationCurve, getPropertyAndReferenceNames（获取对象的各种属性）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景-2"><span class="toc-number">4.2.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#getInfo-和-log-get（工程信息和日志获取）"><span class="toc-number">5.</span> <span class="toc-text">getInfo 和 log.get（工程信息和日志获取）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能介绍-2"><span class="toc-number">5.1.</span> <span class="toc-text">功能介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景-3"><span class="toc-number">5.2.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#profiler（分析器功能）"><span class="toc-number">6.</span> <span class="toc-text">profiler（分析器功能）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能介绍-3"><span class="toc-number">6.1.</span> <span class="toc-text">功能介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#startCapture-stopCapture（Capture-开关）"><span class="toc-number">6.1.1.</span> <span class="toc-text">startCapture, stopCapture（Capture 开关）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getBusses-getCursorTime-getRTPCs-getVoiceContributions-getVoices（获取-Profiler-中特定时间点的信息）"><span class="toc-number">6.1.2.</span> <span class="toc-text">getBusses, getCursorTime, getRTPCs, getVoiceContributions, getVoices（获取 Profiler 中特定时间点的信息）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景-4"><span class="toc-number">6.2.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#project-save（保存工程）"><span class="toc-number">7.</span> <span class="toc-text">project.save（保存工程）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能介绍-4"><span class="toc-number">7.1.</span> <span class="toc-text">功能介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景-5"><span class="toc-number">7.2.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#remote（远程连接到游戏）"><span class="toc-number">8.</span> <span class="toc-text">remote（远程连接到游戏）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能介绍-5"><span class="toc-number">8.1.</span> <span class="toc-text">功能介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#connect-disconnect（连接，断开连接）"><span class="toc-number">8.1.1.</span> <span class="toc-text">connect, disconnect（连接，断开连接）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getAvailableConsoles-getConnectionStatus（查看当前可用的控制台和获得当前连接状态）"><span class="toc-number">8.1.2.</span> <span class="toc-text">getAvailableConsoles, getConnectionStatus（查看当前可用的控制台和获得当前连接状态）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景-6"><span class="toc-number">8.2.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#soundbank（SoundBank-生成与内容设置）"><span class="toc-number">9.</span> <span class="toc-text">soundbank（SoundBank 生成与内容设置）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能介绍-6"><span class="toc-number">9.1.</span> <span class="toc-text">功能介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景-7"><span class="toc-number">9.2.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#switchContainer（Switch-容器内操作）"><span class="toc-number">10.</span> <span class="toc-text">switchContainer（Switch 容器内操作）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能介绍-7"><span class="toc-number">10.1.</span> <span class="toc-text">功能介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景-8"><span class="toc-number">10.2.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#transport（走带条控制）"><span class="toc-number">11.</span> <span class="toc-text">transport（走带条控制）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能介绍-8"><span class="toc-number">11.1.</span> <span class="toc-text">功能介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#create-destroy-executeAction"><span class="toc-number">11.1.1.</span> <span class="toc-text">create, destroy, executeAction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getList-getState"><span class="toc-number">11.1.2.</span> <span class="toc-text">getList, getState</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景-9"><span class="toc-number">11.2.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undo（撤销）"><span class="toc-number">12.</span> <span class="toc-text">undo（撤销）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能介绍-9"><span class="toc-number">12.1.</span> <span class="toc-text">功能介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景-10"><span class="toc-number">12.2.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">13.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实例"><span class="toc-number">14.</span> <span class="toc-text">实例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-导入-Sound-SFX-并建立层级结构并设置一些属性，随后为这个-Sound-SFX-创建-Event-并设置动作类型。最后创建-SoundBank，并添加之前创建的-Event，并生成这个-SoundBank"><span class="toc-number">14.1.</span> <span class="toc-text">1. 导入 Sound SFX 并建立层级结构并设置一些属性，随后为这个 Sound SFX 创建 Event 并设置动作类型。最后创建 SoundBank，并添加之前创建的 Event，并生成这个 SoundBank</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#选定-API"><span class="toc-number">14.1.1.</span> <span class="toc-text">选定 API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#编写代码"><span class="toc-number">14.1.2.</span> <span class="toc-text">编写代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-获取当前工程全局信息、Sound-SFX-大小、SoundBank-大小"><span class="toc-number">14.2.</span> <span class="toc-text">2. 获取当前工程全局信息、Sound SFX 大小、SoundBank 大小</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#选定-API-1"><span class="toc-number">14.2.1.</span> <span class="toc-text">选定 API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#编写代码-1"><span class="toc-number">14.2.2.</span> <span class="toc-text">编写代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-简易实现-Soundcaster-中-Session-和播放功能"><span class="toc-number">14.3.</span> <span class="toc-text">3. 简易实现 Soundcaster 中 Session 和播放功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#选定-API-2"><span class="toc-number">14.3.1.</span> <span class="toc-text">选定 API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#编写代码-2"><span class="toc-number">14.3.2.</span> <span class="toc-text">编写代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-抓取-Profiler-数据生成报告"><span class="toc-number">14.4.</span> <span class="toc-text">4. 抓取 Profiler 数据生成报告</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#选定-API-3"><span class="toc-number">14.4.1.</span> <span class="toc-text">选定 API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#编写代码-3"><span class="toc-number">14.4.2.</span> <span class="toc-text">编写代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#接下来讲什么？"><span class="toc-number">15.</span> <span class="toc-text">接下来讲什么？</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">溪夜</div><div class="author-info__description text-center">一位 Technical Sound Designer / Sound Engineer / iOS Music Maker / Gearslut / Synth-Lover / Extreme Metal Vocalist / Guitarist / LLer / 惠海人 / 明日香老缠粉 / 音频行业恐怖分子</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">21</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">2</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">1</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友情链接</div><a class="author-info-links__name text-center" href="https://sololand.moe/" target="_blank">zpan的独奏乡</a><a class="author-info-links__name text-center" href="http://jazzlost.me/" target="_blank">李AA的博客</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.cnn.com/cnnnext/dam/assets/170407220916-04-iconic-mountains-matterhorn-restricted.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">溪夜的音频博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a><a class="site-page" href="/">Home（主页）</a><a class="site-page" href="/about">About（关于）</a><a class="site-page" href="/archives">Archives（文章归档）</a><a class="site-page" href="/tags">Tags（标签）</a></span></div><div id="post-info"><div id="post-title">人人都能用 WAAPI（二）wwise.core 分支</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-09-05</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">7.7k</span><span class="post-meta__separator">|</span><span>阅读时长: 25 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>大家好，我是溪夜。<br>在《人人都能用 WAAPI（一）概述》中，我们用思维导图对 WAAPI 进行了重新归纳，并在配置好开发环境后，一起用 Python 写了几个简单的小程序，体验了 WAAPI 强大功能的冰山一角。<br>从第二篇起，我们会开始介绍 WAAPI 的所有分支。为了不当一个讨厌的<strong>“文档翻译官”</strong>，我会努力用简单化的语言来描述 WAAPI 的功能，并在最后把 API 组成简单的示例程序。<br>考虑到 Audiokinetic 官网无代码框，我在 GitHub 创建了一个仓库，其中包括了本系列文章中所有的代码，地址为：<a href="https://github.com/zcyh147/Everyone-can-use-WAAPI" target="_blank" rel="noopener">https://github.com/zcyh147/Everyone-can-use-WAAPI</a></p>
<blockquote>
<p>阅前须知：</p>
<ul>
<li><strong>把 API 逐条列出讲解的主要目的是为了快速阐述其功能，补充文档叙述中的一些不足，以帮助大家快速对 WAAPI 建立印象</strong>。在这里并非有意重写文档，所以建议看完本文后按照第一篇文中所提的方法，用自己喜欢的整理方式重新整理一次。</li>
<li>本文并不会把每个参数全都翻译并复述一遍功能，这里<strong>均假设读者已学会了概述中的 JSON 阅读方法，能够自行根据我的介绍查阅 WAAPI 参数及返回值等文档信息，并希望读者在阅读时能准确的找到在线文档中对应的章节以便于及时参考。</strong></li>
<li>为了照顾初学者，我尽量把注释写到每一行，以便快速入门。</li>
<li>学会 RTFM（Read The Fucking Manual），因为接下来的文章比较严肃。<strong>如发现某些概念看不懂或找不到，请善用 Wwise 文档强大的搜索功能或通过 Google 检索所需答案。</strong></li>
<li><strong>因为 WAAPI 的功能也是随版本更新逐渐添加的，建议安装最新版 Wwise 进行学习。</strong>当报错信息提示 “The procedure URI is unknown.” 时，就代表你的当前 WAAPI 版本并不支持此 API。</li>
</ul>
</blockquote>
<p>本文目录：</p>
<p>[toc]</p>
<h2 id="wwise-core-概览"><a href="#wwise-core-概览" class="headerlink" title="wwise.core 概览"></a>wwise.core 概览</h2><p><img src="/images/wwisecore.png" alt="wwisecore"><br><strong>作为 WAAPI 中最大的模块（以我在上一篇提出的分类逻辑），<code>wwise.core</code> 承载着最多的功能。</strong>除了它与 <code>soundengine</code> 模块外，执行类剩余的几个模块的功能相对简单，所以 <code>wwise.core</code> 会成为我们投入精力最多的一个部分。<br>简单的看一下上面的思维导图，不难看出本模块的功能主要针对 Wwise 音频设计部分，而不是对声音引擎。这也代表<strong>如果你有一些对 Wwise 操作级的优化想法，这会是对你最为重要的章节。</strong><br>注意：图中划线的部分代表 WAAPI 中已被新功能替代的部分。</p>
<h2 id="audio（导入音频并创建对象）"><a href="#audio（导入音频并创建对象）" class="headerlink" title="audio（导入音频并创建对象）"></a>audio（导入音频并创建对象）</h2><h3 id="功能简介"><a href="#功能简介" class="headerlink" title="功能简介"></a>功能简介</h3><p><code>audio</code> 分支下有 <code>import</code> 和 <code>importTabDelimited</code>，根据名字容易看出这是负责导入音频资源的功能。这两者的区别是<strong>前者只能导入音频并创建对象</strong>，<strong>后者为根据“制表符分割文件”中所定制的规则导入音频并执行相关操作</strong>。<br>所谓制表符分割文件导入文件，即<strong>在音频文件导入时使用一个制表符分割的文本文件读取提前规定的被导入相关属性（例如音频文件在本机的储存位置、Wwise 中它要所产生对象在各个层级〔各种容器、Event、Output Bus〕的位置、设定属性值和引用、Switch 指派子元素等）。</strong><br>这种文本文件可使用 Excel 或者其它电子表格工具生成，其中的第一行所填写的内容定义了每列的标题所定义的属性，每列中的内容决定了在 Wwise 中建立什么内容。</p>
<h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><p>不难看出，<code>audio</code> 分支是最重要的资源导入分支，<strong>也是大部分实用性 WAAPI 程序的起点。</strong>这类工具的功能致力于帮助减少人工导入大量文件时带来的繁琐操作，同时根据所定义的信息能够自动完成层级、属性、流播放等设定。<br><strong>如果想通过 <code>import</code> 导入音频文件，就需要再文件名上定义其在工程中的各种位置和属性。为此，要建立一个词典对应文件名中的代号，以减少文件名过长带来的报错可能。</strong><br>因为操作系统对于文件名和路径的长度有所限制，所以 Wwise 中的文件名长度要受此约束，理论只支持最大256字符长度文件名的资源导入。再加上系统路径所占用的字符数，最后往往给不到用户那么多可用字符，也会直接带来错误。<br>我们也可利用 <code>importTabDelimited</code> 通过制表符分割文件完成导入工作，因为需在 Excel 中定义符合 Wwise 可识别信息规则的制表符分隔 txt 文件。对于这个步骤其实也可进行优化。例如可通过 VBA 给声音设计师创建一个在 Excel 中快速对制表符分割文件结构构建的程序，或使用 Python 创建一个更完备的 GUI 程序以完成制表符分割文件的快速创建等。</p>
<h2 id="audioSourcePeaks（音频源峰值获取）"><a href="#audioSourcePeaks（音频源峰值获取）" class="headerlink" title="audioSourcePeaks（音频源峰值获取）"></a>audioSourcePeaks（音频源峰值获取）</h2><h3 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h3><p>此分支下有 <code>getMinMaxPeaksInRegion</code> 和 <code>getMinMaxPeaksInTrimmedRegion</code>，其功能为获取音频峰值并返回相关信息。两者的区别是前者返回的是用户所选区域的峰值，后者是对修剪过后的音频取峰值。<strong>注意这个峰值不是唯一的 Max Peak，而是根据 numPeaks 参数指定数量的 Min/Max Peak。</strong><br>在 <code>getMinMaxPeaksInRegion</code> 的参数中，可看到 <code>timeFrom</code> 和 <code>timeTo</code>，这两者用来确定取值区域的开始和结束时间。<br><code>getMinMaxPeaksInTrimmedRegion</code> 则无需指定开始结束时间，会直接对 SFX 对象裁剪后的部分进行求值。<br><code>audioSourcePeaks</code> 两个功能的返回值都是使用 Base 64 编码的16位有符号 int 数组。所以要经过 Base 64 解码，按照给定的格式(fmt)解析字节流，再换算成 dB。</p>
<h3 id="应用场景-1"><a href="#应用场景-1" class="headerlink" title="应用场景"></a>应用场景</h3><p>本人对 Wwise 插件开发了解还不够，但对一段音频取这么多最大/最小峰值点的操作看起来并不是普通的需求，这两个功能提供的最多点位可多达 14294967295。如有需求存在要在 Wwise 内获取音频片段的 Peak 点的操作，可使用此两者进行计算。</p>
<h2 id="object（对象操作）"><a href="#object（对象操作）" class="headerlink" title="object（对象操作）"></a>object（对象操作）</h2><h3 id="功能介绍-1"><a href="#功能介绍-1" class="headerlink" title="功能介绍"></a>功能介绍</h3><h4 id="create-copy-delete-move（对象基本操作）"><a href="#create-copy-delete-move（对象基本操作）" class="headerlink" title="create, copy, delete, move（对象基本操作）"></a>create, copy, delete, move（对象基本操作）</h4><p>这四个功能是最基本的对象操作，分别对应对象的创建、拷贝、删除、移动。所需参数都是围绕着对象名、类型、它现在的位置、之后的位置等跟对象有关的基本参数。<br><code>create</code> 与 <code>audio</code> 功能导入的音频时创建的对象的覆盖范围略有不同，<strong><code>create</code> 能够创建文档中 Wwise Objects Reference 中列出的海量对象，<code>audio</code> 在导入音频的时候则只能创建与音频相关的对象（各类容器、Event 等）。</strong><br><code>create</code> 的功能非常广泛，从创建简单的的 Sound SFX 对象或 Work Unit，创建复杂容器并指定元素，甚至能够创建效果器和声源插件等。</p>
<h4 id="setReference-setRandomizer-setAttenuationCurve-setName-setNotes-setProperty（设置对象的各种属性）"><a href="#setReference-setRandomizer-setAttenuationCurve-setName-setNotes-setProperty（设置对象的各种属性）" class="headerlink" title="setReference, setRandomizer, setAttenuationCurve, setName, setNotes, setProperty（设置对象的各种属性）"></a>setReference, setRandomizer, setAttenuationCurve, setName, setNotes, setProperty（设置对象的各种属性）</h4><p><code>create</code> 创建对象时只能设置即少量属性（比如本小节中提到的六个 API 里，只有 Notes 能在对象创建的时候被设置），所以我们需要通过上面的这些功能进一步设置对象属性。<br>其中 <code>setReference</code> 为设置引用，如想要为一个 SFX 对象设置输出 Bus，就需要为这个对象添加对某个 Bus 的引用。<br><code>setRandomizer, setAttenuationCurve, setName, setNotes</code> 这些功能为语义本身功能，设置随机、衰减曲线、名字、笔记。<br><code>setProperty</code> 是真正用来设置大量属性的命令，在文档的 Wwise Objects Reference 中我们可以看到大量有关对象的信息，点开某一个，你就可以看到其能被设置的所有属性名。<br>举例来说，如果想对 Mastering Suite 中的某项属性进行设置，只需提供它的 GUID 或路径这类位置信息，再把 “property” 键对应的值修改为要修改的属性名，最后提供合适的值即可完成属性修改。</p>
<h4 id="get-getTypes-getPropertyInfo-getAttenuationCurve-getPropertyAndReferenceNames（获取对象的各种属性）"><a href="#get-getTypes-getPropertyInfo-getAttenuationCurve-getPropertyAndReferenceNames（获取对象的各种属性）" class="headerlink" title="get, getTypes, getPropertyInfo, getAttenuationCurve, getPropertyAndReferenceNames（获取对象的各种属性）"></a>get, getTypes, getPropertyInfo, getAttenuationCurve, getPropertyAndReferenceNames（获取对象的各种属性）</h4><p>如果想获取现有工程的各种数据，就需要用 <code>get</code> 这几个功能。<br><strong><code>get</code> 是基于 query（查询）的功能，它能够获取到大量工程信息，例如 ID、名字、占用空间大小、路径、播放长度等，设定好合适的查询参数即可完成查询。</strong>就像我们在概述篇提到的，它可同时传入 Arguments 和 Options 两个参数，在使用时可按需设置 Options 来控制查询的返回结果。<br>这里解释一下其所使用的两个参数的含义。<br>其中 Arguments 中含有 from 和 transform 两个子参数：</p>
<ol>
<li>from 为查询的数据来源，即以名字、GUID、路径，类型等作为限制条件来搜寻对象。除了对单个对象 GUID 的查询，其中还有些条件比如 <code>ofType</code> 或者 <code>search</code> 能够找出符合条件的一整类对象。</li>
<li>transform 比较有趣，功能是对已选择的对象进行变换。比如我们现在在 from 中设定选择了某个层级下的 Random Container，此时在 transform 中再添加 select parent，就会转而选择上级对象。transform 是 from 的一种重要补充，能够方便的对已设定的 from 条件进行父级、子级和引用等的查询。</li>
</ol>
<p>Options 中含有 return 和 platform 两个子参数，注意 Options 是可以留空的：</p>
<ol>
<li>return 指定了对象被查询后返回什么内容，留空则默认返回 GUID 和对象名。</li>
<li>platform 指定了查询什么平台下的结果，留空的话会查询默认平台。</li>
</ol>
<p>那为什么还要有 <code>getTypes, getPropertyInfo, getAttenuationCurve, getPropertyAndReferenceNames, getPropertyNames</code> 呢？<br>其实这是 WAAPI 设计时对功能分工的不同，<code>get</code> 更针对对象的各种属性进行查询。另外四个查询更偏向对象的元属性，<code>getTypes</code> 返回当前所有注册的对象类型，<code>getPropertyInfo</code> 返回对象属性的具体信息（例如取值范围等），<code>getAttenuationCurve</code> 返回特定对象的衰减曲线设置，<code>getPropertyAndReferenceNames</code> 返回对象拥有的属性和当前引用名称。</p>
<h3 id="应用场景-2"><a href="#应用场景-2" class="headerlink" title="应用场景"></a>应用场景</h3><p>对象操作的可应用之处非常多，例如可通过 <code>get</code> 系获取转码后音频文件的空间占用情况、获取对象的属性和引用状况、查询工程中所有的平台、所有正在使用的 Output Bus 等。如果对于 Wwise 的 Queries 功能有所了解，用这个功能会很顺手。 </p>
<h2 id="getInfo-和-log-get（工程信息和日志获取）"><a href="#getInfo-和-log-get（工程信息和日志获取）" class="headerlink" title="getInfo 和 log.get（工程信息和日志获取）"></a>getInfo 和 log.get（工程信息和日志获取）</h2><h3 id="功能介绍-2"><a href="#功能介绍-2" class="headerlink" title="功能介绍"></a>功能介绍</h3><p>这是两个简单的信息获取功能，<code>getInfo</code> 用于获取当前工程全局信息，例如 Wwise 版本、平台信息、WAAPI 版本等。<code>log.get</code> 用于获取最新的日志，Logs 窗口中的那几个选项卡就对应本 API 中的参数 <code>channel</code>。此功能用于获取完整的日志。<br>如果想实现在自己的程序里动态更新日志的状态，则需要用订阅类的功能，有关这部分我们会在之后的章节里进行讨论。例如订阅类中的 <code>ak.wwise.core.log.itemAdded</code>，就是在有对象被添加时返回信息。</p>
<h3 id="应用场景-3"><a href="#应用场景-3" class="headerlink" title="应用场景"></a>应用场景</h3><p>在对工程全局信息和日志有需求时，可根据需求使用这两个功能。因为 <code>log.get</code> 能获取最新的日志，可以在 WAAPI 程序中某些步骤后加入这项功能，从而把每次的日志保存到数据库或进行预想的分析，以获得更为定制化的反馈报告。</p>
<h2 id="profiler（分析器功能）"><a href="#profiler（分析器功能）" class="headerlink" title="profiler（分析器功能）"></a>profiler（分析器功能）</h2><h3 id="功能介绍-3"><a href="#功能介绍-3" class="headerlink" title="功能介绍"></a>功能介绍</h3><h4 id="startCapture-stopCapture（Capture-开关）"><a href="#startCapture-stopCapture（Capture-开关）" class="headerlink" title="startCapture, stopCapture（Capture 开关）"></a>startCapture, stopCapture（Capture 开关）</h4><p>单纯的控制 Profiler Capture 的开始与停止，无需参数即可直接调用。</p>
<h4 id="getBusses-getCursorTime-getRTPCs-getVoiceContributions-getVoices（获取-Profiler-中特定时间点的信息）"><a href="#getBusses-getCursorTime-getRTPCs-getVoiceContributions-getVoices（获取-Profiler-中特定时间点的信息）" class="headerlink" title="getBusses, getCursorTime, getRTPCs, getVoiceContributions, getVoices（获取 Profiler 中特定时间点的信息）"></a>getBusses, getCursorTime, getRTPCs, getVoiceContributions, getVoices（获取 Profiler 中特定时间点的信息）</h4><p>其中 <code>getBusses</code>、<code>getRTPCs</code>、<code>getVoices</code> 为同一类功能，通过传入一个特定的时间作为参数，即可查询 Profiler 此刻的 Bus、RTPC ID、RTPC 值、相关声部等信息。<br><code>getCursorTime</code> 可获取当前 Profiler 光标的位置，并返回时间。<br><code>getVoiceContributions</code> 需要通过管线 ID 和 Profiler 的时间位置，可查询影响干声路径的音量和高低通等参数。<br>注意，其中的 <code>getBusses</code> 和 <code>getVoices</code> 也可传入两个参数，第二个参数用来指定查询范围。</p>
<h3 id="应用场景-4"><a href="#应用场景-4" class="headerlink" title="应用场景"></a>应用场景</h3><p>不难看出，<code>startCapture, stopCapture</code> 可集成到工具上进行手动或自动控制，方便进行比较复杂的捕捉需求。例如使用 Unity WAAPI 客户端，把一些分析的功能做进去，在 Unity 中的控制采集开关。<code>get</code> 类功能可根据需求获取分析数据，再根据需求进行分析之用。</p>
<h2 id="project-save（保存工程）"><a href="#project-save（保存工程）" class="headerlink" title="project.save（保存工程）"></a>project.save（保存工程）</h2><h3 id="功能介绍-4"><a href="#功能介绍-4" class="headerlink" title="功能介绍"></a>功能介绍</h3><p>保存当前工程。</p>
<h3 id="应用场景-5"><a href="#应用场景-5" class="headerlink" title="应用场景"></a>应用场景</h3><p>单纯代替 Ctrl + S 过于简单，比较有用的场景可以是在追求稳定的时候根据触发条件自动保存工程。比如在批量导入上万文件或实行其他批处理操作时，为了工程安全，或许可在每导入100个甚至10个文件时就调用此功能保存一次，以避免任何潜在的不安全。</p>
<h2 id="remote（远程连接到游戏）"><a href="#remote（远程连接到游戏）" class="headerlink" title="remote（远程连接到游戏）"></a>remote（远程连接到游戏）</h2><h3 id="功能介绍-5"><a href="#功能介绍-5" class="headerlink" title="功能介绍"></a>功能介绍</h3><h4 id="connect-disconnect（连接，断开连接）"><a href="#connect-disconnect（连接，断开连接）" class="headerlink" title="connect, disconnect（连接，断开连接）"></a>connect, disconnect（连接，断开连接）</h4><p>对于看过 Wwise 一分钟的小伙伴，应该看过侯老师亲自配音的“如何使用WAAPI将Wwise连接到您的游戏”（<a href="https://www.bilibili.com/video/BV11E411P7GW），在视频中就是通过" target="_blank" rel="noopener">https://www.bilibili.com/video/BV11E411P7GW），在视频中就是通过</a> <code>connect</code> 完成了连接操作。注意，调用 <code>connect</code> 时需要提供主机 IP 并可选提供端口号，这也是为什么下面的 <code>getAvailableConsoles</code> 要存在，如果有连接到不同的游戏引擎中的需求，就可通过此功能先获取可连接的客户端列表再进行操作。</p>
<h4 id="getAvailableConsoles-getConnectionStatus（查看当前可用的控制台和获得当前连接状态）"><a href="#getAvailableConsoles-getConnectionStatus（查看当前可用的控制台和获得当前连接状态）" class="headerlink" title="getAvailableConsoles, getConnectionStatus（查看当前可用的控制台和获得当前连接状态）"></a>getAvailableConsoles, getConnectionStatus（查看当前可用的控制台和获得当前连接状态）</h4><p><code>getAvailableConsoles</code> 用来获取当前可用的控制台，即查看当前有哪些跟 Wwise 可连接的游戏引擎工程，并返回编辑器名字、IP、端口、平台等信息。<br><code>getConnectionStatus</code> 则是获取当前连接状态，只有已经跟游戏引擎连接上以后，才会返回它们的控制台信息和连接状态。</p>
<h3 id="应用场景-6"><a href="#应用场景-6" class="headerlink" title="应用场景"></a>应用场景</h3><p><code>remote</code> 中的连接和断开连接功能，就像 Wwise 一分钟里所讲可以直接设置到游戏中的菜单上，从而进行点击调用来达到快速连接游戏。或者通过 StreamDeck 和 Metagrid 这样的工具快速触发 Python 脚本来激活远程连接，能够有效减少操作浪费的时间。<br>对于 <code>getAvailableConsoles</code> 和 <code>getConnectionStatus</code>，如果大家记得 <code>profiler</code> 部分，相信能想到把这两个紧密相关的功能结合，可以把 Wwise 分析器的数据搬到自己的程序中。比如自动化提取想要的信息，或者简单的在自己的程序里告知用户当前连接状态如何，以实现比较完善的 Wwise 外工作流。</p>
<h2 id="soundbank（SoundBank-生成与内容设置）"><a href="#soundbank（SoundBank-生成与内容设置）" class="headerlink" title="soundbank（SoundBank 生成与内容设置）"></a>soundbank（SoundBank 生成与内容设置）</h2><h3 id="功能介绍-6"><a href="#功能介绍-6" class="headerlink" title="功能介绍"></a>功能介绍</h3><p><code>generate</code> 意如其名，负责生成 SoundBank。我们知道，日常生成 SoundBank 时除了全部生成外，还可勾选特定的 SoundBank、平台、语言来生成，同理，使用 <code>generate</code> 时也需要设置这些参数。<br><code>getInclusions</code> 可以返回 SoundBank 内包含所有 Event 的列表，其中包括 GUID 和 Event 所含的层级结构。<br><code>setInclusions</code> 负责设置 SoundBank 内包含的内容，可以对内容添加、删除、替换。</p>
<h3 id="应用场景-7"><a href="#应用场景-7" class="headerlink" title="应用场景"></a>应用场景</h3><p><code>soundbank</code> 类中如果想对不存在的 SoundBank 进行内容设置，需先通过 <code>create</code> 进行创建 SoundBank 对象和层级，之后才能继续设置包内内容。<br><strong>至此，一套完整的创建工作流就产生了，<code>audio</code> 类负责导入音频并创建音频层级结构，<code>create</code> 类可以创建并构建各种其他层级和 Event 等，最后由 <code>soundbank</code> 类负责收尾创建 SoundBank。</strong>这套工作流可用于根据外部设定的结构文件自动化创建，或在 Wwise 外的控制程序上通过 <code>soundbank</code> 检视工程内部结构。</p>
<h2 id="switchContainer（Switch-容器内操作）"><a href="#switchContainer（Switch-容器内操作）" class="headerlink" title="switchContainer（Switch 容器内操作）"></a>switchContainer（Switch 容器内操作）</h2><h3 id="功能介绍-7"><a href="#功能介绍-7" class="headerlink" title="功能介绍"></a>功能介绍</h3><p>在讨论 <code>create</code> 类时我们谈到它可以创建各种容器，其中就包括 Switch Container。<strong>那为什么这里又出现了 <code>switchContainer</code> 呢</strong>？<br>众所周知，Switch Container 指派了控制当前容器的 Switch/State Group 后，需要对每一个引入的 Switch/State 指派容器中的对象，这样才让能 Switch Container 有实际的工作意义。<br>WAAPI 中把对 Switch Container 中进行指派的这类操作独立出来，使用 <code>switchContainer</code> 类来进行相关操作。<br><code>addAssignment</code> 和 <code>removeAssignment</code> 分别为添加与去除 Switch 指派的功能，只需要提供 Switch Container 中对象的 GUID 和目标 Switch/State Group 中的 Switch/State 的 GUID 即可轻松完成删减。<br><code>getAssignments</code>是一个非常简单的功能，给定 Switch Container 的 GUID，会返回当前容器下所有子对象的 GUID 和指定的 Switch/State 的 GUID。</p>
<h3 id="应用场景-8"><a href="#应用场景-8" class="headerlink" title="应用场景"></a>应用场景</h3><p><code>switchContainer</code> 的应用场景很简单，可作为自动化导入工具流的补充，对导入时创建的容器进行 Switch 元素指派。</p>
<h2 id="transport（走带条控制）"><a href="#transport（走带条控制）" class="headerlink" title="transport（走带条控制）"></a>transport（走带条控制）</h2><h3 id="功能介绍-8"><a href="#功能介绍-8" class="headerlink" title="功能介绍"></a>功能介绍</h3><h4 id="create-destroy-executeAction"><a href="#create-destroy-executeAction" class="headerlink" title="create, destroy, executeAction"></a>create, destroy, executeAction</h4><p><code>create, destroy</code> 为一对功能，前者是在当前工程中创建一个走带条对象（Transport Object），后者是销毁这个走带条对象。因为是针对对象的操作，所以创建时需要对象的 GUID，销毁时需要走带条对象的 ID。<br><strong>什么叫走带条对象？</strong>其实在 Wwise 日常的工作中我们无时无刻不在重复这两个动作。<br>例如选中 Event A，走带处的控制焦点会变成控制它的状态，即为其创建了一个走带条对象。此时选中其他对象，这个走带条对象销毁，创建下一个。如果点击了走带条上的 Pin，这个走带条对象就会持续存在，而其他对象的走带条对象创建被阻滞。<br>对于 Soundcaster 来说，每个 Session 其实就是一堆走带条对象的集合。<br><code>executeAction</code> 功能如其名，可以控制走带条对象的播放行为，它具有五种 Action 可供使用。</p>
<h4 id="getList-getState"><a href="#getList-getState" class="headerlink" title="getList, getState"></a>getList, getState</h4><p><code>getList</code> 为获取当前工程内所有走带条对象，在 WAAPI 中走带条对象创建后如没经过 <code>destroy</code> 手工销毁，可通过此功能查看当前还存在的走带条对象。<br><code>getState</code> 为获取走带条对象的状态，在 <code>executeAction</code> 为走带条对象指定播放状态后可通过此命令进行查询。</p>
<h3 id="应用场景-9"><a href="#应用场景-9" class="headerlink" title="应用场景"></a>应用场景</h3><p><code>transport</code> 类的功能应用场景比较简单，如果想在 Wwise 外的程序里创建简单的播放行为控制功能，可通过其进行实现。这个外部的程序可以是自己的外置集成工具，也可以是通过 WAAPI 在声音引擎中对 Wwise 中的声音进行预览，甚至在 Wwise 外可复刻一个 Soundcaster。</p>
<h2 id="undo（撤销）"><a href="#undo（撤销）" class="headerlink" title="undo（撤销）"></a>undo（撤销）</h2><h3 id="功能介绍-9"><a href="#功能介绍-9" class="headerlink" title="功能介绍"></a>功能介绍</h3><p><code>beginGroup</code> 和 <code>endGroup</code> 的概念对于接触过 ReaScript 的人可能更容易理解一些，功能类似 ReaScript 中的 Undo_BeginBlock() 和 Undo_EndBlock()。即执行完 <code>beginGroup</code> 后到执行 <code>endGroup</code> 之前所有的操作都会被保存为一个 Undo Group。其中 <code>beginGroup</code> 可以被堆叠使用。<br><code>cancelGroup</code> 为撤销最后一个 Undo Group 内的所有操作。</p>
<h3 id="应用场景-10"><a href="#应用场景-10" class="headerlink" title="应用场景"></a>应用场景</h3><p>Undo Group 是把一串行为一次性撤销的设计，当然，Undo Group 理应也可以作为 Redo 来使用，不过 WAAPI 中目前只有撤销功能，所以想实现 Redo 还需等待 API 更新。从应用场景来说，<code>undo</code> 类功能可为 Wwise 外工具增添撤销功能。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><strong>如果按照顺序读下来感到有些遗忘是正常的。</strong>这也是为什么在开头我建议大家看完这篇文章后自己对 WAAPI 进行一次重构的原因。<br>要把 WAAPI 做成自己的武器库，应该按照如下步骤进行：</p>
<ol>
<li>整理出你自己的 WAAPI 框架，无论是详细的笔记还是简略的思维导图</li>
<li>发散思维，思考自己要解决音频设计与整合工作中的哪些痛点</li>
<li>抽象出头脑中原型的逻辑，并寻找到可使用的 API</li>
<li>完成功能代码</li>
</ol>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>单纯的介绍是枯燥的，下面通过实例体验一下 WAAPI 的应用。<br><strong>因示例更注重功能代码实现，故不会像真实项中一样进行交互设计或者加入 GUI。</strong>所以这部分代码实际上是从程序里抽象出的核心功能代码，如果想要应用到自己的程序上，只需为其设计交互层即可。<br>在这里我会尽量覆盖到 <code>wwise.core</code> 分支下的 API，少量没用上的功能大家可自行研究，使用原理上区别不大。</p>
<blockquote>
<p>以下代码的重点是参数调用方法，当遇到奇怪的 Bug 时仔细看看你写的和示例的区别，应该就能找到问题所在。<br>为了方便使用，我把每个功能都封装到了函数里，可修改概述中 Functions（执行类）示例的执行代码以上在本机试用。<br>Wwise 在 macOS 下的目录结构与 Windows 不同，因为其运行在 Wine 中，在 macOS 端进行尝试的同学请注意一下文件路径的问题（点击菜单中的 Project，在最近访问的工程处可查看 Wine 中 Wwise 的具体目录）。</p>
</blockquote>
<h3 id="1-导入-Sound-SFX-并建立层级结构并设置一些属性，随后为这个-Sound-SFX-创建-Event-并设置动作类型。最后创建-SoundBank，并添加之前创建的-Event，并生成这个-SoundBank"><a href="#1-导入-Sound-SFX-并建立层级结构并设置一些属性，随后为这个-Sound-SFX-创建-Event-并设置动作类型。最后创建-SoundBank，并添加之前创建的-Event，并生成这个-SoundBank" class="headerlink" title="1. 导入 Sound SFX 并建立层级结构并设置一些属性，随后为这个 Sound SFX 创建 Event 并设置动作类型。最后创建 SoundBank，并添加之前创建的 Event，并生成这个 SoundBank"></a>1. 导入 Sound SFX 并建立层级结构并设置一些属性，随后为这个 Sound SFX 创建 Event 并设置动作类型。最后创建 SoundBank，并添加之前创建的 Event，并生成这个 SoundBank</h3><p><strong>快速导入音频文件到 Wwise 中并建立所需的音频层级，甚至建立 Event，这无疑会极大提高音频整合时的效率。</strong>在下面的实例中我们需要手工的在参数中填写文件路径、属性、层级等相关信息，在实际工作中可以发挥想象力，把工具中这部分繁琐的工序也解决掉。<br>比如通过规范的文件名代号、与数据库联动、正则表达式等方法让文件在导入前有足够的元数据准备，再通过你所使用的编程语言自动把这种格式化好的文件名格转化为 WAAPI 导入文件所需设置 JSON 参数，即可真正实现把音频快速导入 Wwise 工程的目的。</p>
<h4 id="选定-API"><a href="#选定-API" class="headerlink" title="选定 API"></a>选定 API</h4><ul>
<li>导入文件：<code>import</code></li>
<li>设置属性：<code>setProperty</code> </li>
<li>创建 Event 并添加声音、创建 SoundBank：<code>create</code></li>
<li>组装并生成 SoundBank：<code>setInclusions</code>、<code>generate</code></li>
</ul>
<h4 id="编写代码"><a href="#编写代码" class="headerlink" title="编写代码"></a>编写代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 导入文件并建立音频层级</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">file_import</span><span class="params">(file_path)</span>:</span></span><br><span class="line">    <span class="comment"># 定义文件导入参数，imports 中包含了硬盘中的文件路径和目标路径，目标路径中包括对创建对象的类型定义。</span></span><br><span class="line">    <span class="comment"># 对于非语音的 Sound SFX，importLanguage 使用 SFX。importOperation 为 useExisting，这代表了如果已经有所需的容器存在就直接替换，如果没有就创建一个。</span></span><br><span class="line">    args_import = &#123;</span><br><span class="line">        <span class="string">"importOperation"</span>: <span class="string">"useExisting"</span>, </span><br><span class="line">        <span class="string">"default"</span>: &#123;</span><br><span class="line">            <span class="string">"importLanguage"</span>: <span class="string">"SFX"</span></span><br><span class="line">        &#125;, </span><br><span class="line">        <span class="string">"imports"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"audioFile"</span>: file_path, </span><br><span class="line">                <span class="string">"objectPath"</span>: <span class="string">"\\Actor-Mixer Hierarchy\\Default Work Unit\\&lt;Sequence Container&gt;Test 0\\&lt;Sound SFX&gt;My SFX 0"</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># 定义返回结果参数，让其只返回 Windows 平台下的信息，信息中包含 GUID 和新创建的对象名</span></span><br><span class="line">    opts = &#123;</span><br><span class="line">        <span class="string">"platform"</span>: <span class="string">"Windows"</span>,</span><br><span class="line">        <span class="string">"return"</span>: [</span><br><span class="line">            <span class="string">"id"</span>, <span class="string">"name"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> client.call(<span class="string">"ak.wwise.core.audio.import"</span>, args_import, options=opts)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 设置音频属性</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_property</span><span class="params">(object_guid)</span>:</span></span><br><span class="line">    <span class="comment"># 设定参数里的目标对象为所需修改对象的 GUID，修改的属性为 Volume，对象所在的平台为 Mac，数值修改为 10。</span></span><br><span class="line">    args_property = &#123;</span><br><span class="line">        <span class="string">"object"</span>: object_guid, </span><br><span class="line">        <span class="string">"property"</span>: <span class="string">"Volume"</span>, </span><br><span class="line">        <span class="string">"platform"</span>: <span class="string">"Windows"</span>, </span><br><span class="line">        <span class="string">"value"</span>: <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    client.call(<span class="string">"ak.wwise.core.object.setProperty"</span>, args_property)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 对 Sound SFX 创建 Event，并设定播放规则</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_event</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 对一个 Sound SFX 对象创建 Event 并定义其播放行为为播放</span></span><br><span class="line">    args_new_event = &#123;</span><br><span class="line">        <span class="comment"># 上半部分属性中分别为 Event 创建后存放的路径、类型、名称、遇到名字冲突时的处理方法</span></span><br><span class="line">        <span class="string">"parent"</span>: <span class="string">"\\Events\\Default Work Unit"</span>, </span><br><span class="line">        <span class="string">"type"</span>: <span class="string">"Event"</span>, </span><br><span class="line">        <span class="string">"name"</span>: <span class="string">"Play_SFX"</span>, </span><br><span class="line">        <span class="string">"onNameConflict"</span>: <span class="string">"merge"</span>, </span><br><span class="line">        <span class="string">"children"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment"># 为其创建播放行为，名字留空，使用 @ActionType 定义其播放行为为 Play，@Target 为被播放的声音对象</span></span><br><span class="line">                <span class="string">"name"</span>: <span class="string">""</span>, </span><br><span class="line">                <span class="string">"type"</span>: <span class="string">"Action"</span>, </span><br><span class="line">                <span class="string">"@ActionType"</span>: <span class="number">1</span>, </span><br><span class="line">                <span class="string">"@Target"</span>: <span class="string">"\\Actor-Mixer Hierarchy\\Default Work Unit\\Test 0\\My SFX 0"</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> client.call(<span class="string">"ak.wwise.core.object.create"</span>, args_new_event&#123;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 创建 SoundBank，并对其添加 Event</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_soundbank</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 在 SoundBanks 文件夹的 Default Work Unit 里创建一个 Soundbank</span></span><br><span class="line">    args_new_event = &#123;</span><br><span class="line">        <span class="string">"parent"</span>: <span class="string">"\\SoundBanks\\Default Work Unit"</span>, </span><br><span class="line">        <span class="string">"type"</span>: <span class="string">"SoundBank"</span>, </span><br><span class="line">        <span class="string">"name"</span>: <span class="string">"Just_a_Bank"</span>, </span><br><span class="line">        <span class="string">"onNameConflict"</span>: <span class="string">"replace"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># 接收返回值</span></span><br><span class="line">    soundbank_info = client.call(<span class="string">"ak.wwise.core.object.create"</span>, args_create_soundbank)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 给刚创建完的 SoundBank 添加内容，把上面创建的 Event 放进去</span></span><br><span class="line">    args_set_inclusion = &#123;</span><br><span class="line">        <span class="string">"soundbank"</span>: <span class="string">"\\SoundBanks\\Default Work Unit\\Just_a_Bank"</span>, </span><br><span class="line">        <span class="string">"operation"</span>: <span class="string">"add"</span>, </span><br><span class="line">        <span class="string">"inclusions"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment"># 此处为 Just_a_Bank 内要放入的内容，filter 是要把哪些数据放进 SoundBank</span></span><br><span class="line">                <span class="string">"object"</span>: <span class="string">"\\Events\\Default Work Unit\\Play_SFX"</span>, </span><br><span class="line">                <span class="string">"filter"</span>: [</span><br><span class="line">                    <span class="string">"events"</span>, </span><br><span class="line">                    <span class="string">"structures"</span>,</span><br><span class="line">                    <span class="string">"media"</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> client.call(<span class="string">"ak.wwise.core.soundbank.setInclusions"</span>, args_set_inclusion)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 生成 SoundBank</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_soundbank</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 设定需要导出的 SoundBank 名字，并设置为写入到磁盘</span></span><br><span class="line">    args_generate_soundbank = &#123;</span><br><span class="line">        <span class="string">"soundbanks"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"name"</span>: <span class="string">"Ambient"</span></span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"writeToDisk"</span>: <span class="keyword">True</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> client.call(<span class="string">"ak.wwise.core.soundbank.generate"</span>, args_generate_soundbank)</span><br></pre></td></tr></table></figure>
<h3 id="2-获取当前工程全局信息、Sound-SFX-大小、SoundBank-大小"><a href="#2-获取当前工程全局信息、Sound-SFX-大小、SoundBank-大小" class="headerlink" title="2. 获取当前工程全局信息、Sound SFX 大小、SoundBank 大小"></a>2. 获取当前工程全局信息、Sound SFX 大小、SoundBank 大小</h3><h4 id="选定-API-1"><a href="#选定-API-1" class="headerlink" title="选定 API"></a>选定 API</h4><ul>
<li>获取全局信息：<code>getInfo</code></li>
<li>获取 Sound SFX 转码后大小：<code>get</code></li>
<li>获取生成的 SoundBank 路径：<code>get</code></li>
</ul>
<h4 id="编写代码-1"><a href="#编写代码-1" class="headerlink" title="编写代码"></a>编写代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 获取全局信息</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_global_info</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 通过 getInfo 查询工程信息</span></span><br><span class="line">    <span class="keyword">return</span> client.call(<span class="string">"ak.wwise.core.getInfo"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 获取 Sound SFX 的大小</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_sfx_and_event_size</span><span class="params">(sound_sfx_guid)</span>:</span></span><br><span class="line">    <span class="comment"># 设置查询参数为对象的 GUID</span></span><br><span class="line">    args = &#123;</span><br><span class="line">        <span class="string">"from"</span>: &#123;</span><br><span class="line">            <span class="string">"id"</span>: [</span><br><span class="line">                sound_sfx_guid</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 设定返回值为对象名字和转码后的大小</span></span><br><span class="line">    opts = &#123;</span><br><span class="line">        <span class="string">"return"</span>: [</span><br><span class="line">            <span class="string">"name"</span>, <span class="string">"totalSize"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> client.call(<span class="string">"ak.wwise.core.object.get"</span>, args, options=opts)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 获取工程生成后的的 SoundBank 大小</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_soundbank_size</span><span class="params">(soundbank_guid)</span>:</span></span><br><span class="line">    <span class="comment"># 同上例</span></span><br><span class="line">    args = &#123;</span><br><span class="line">        <span class="string">"from"</span>: &#123;</span><br><span class="line">            <span class="string">"id"</span>: [</span><br><span class="line">                soundbank_guid</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 设定返回值为 Windows 平台下 SoundBank 生成后的路径</span></span><br><span class="line">    opts = &#123;</span><br><span class="line">        <span class="string">"platform"</span> : <span class="string">"Windows"</span>,</span><br><span class="line">        <span class="string">"return"</span>: [</span><br><span class="line">            <span class="string">"soundbank:bnkFilePath"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">     <span class="comment"># 对得到的 SoundBank 地址使用 os.path.getsize() 获取大小，并换算成 MB。Mac 下的 Wwise 返回目录值需处理才可使用，在此不加以讨论。</span></span><br><span class="line">    path =  client.call(<span class="string">"ak.wwise.core.object.get"</span>, args, options=opts)[<span class="string">'return'</span>][<span class="number">0</span>]</span><br><span class="line">    size = os.path.getsize(path) / (<span class="number">1024</span> ** <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> size</span><br></pre></td></tr></table></figure>
<h3 id="3-简易实现-Soundcaster-中-Session-和播放功能"><a href="#3-简易实现-Soundcaster-中-Session-和播放功能" class="headerlink" title="3. 简易实现 Soundcaster 中 Session 和播放功能"></a>3. 简易实现 Soundcaster 中 Session 和播放功能</h3><p>Soundcaster 的功能主要由两部分组成，其一是保存一组走带条对象数据方便复用（即 Soundcaster Session），其二是在播放时可控制 Game Sync 及对象的属性、M/S 等。<br>因为第二部分中有些功能比较复杂，在示例中我们只完成第一个部分。<br>注意：WAAPI 中的 Transport Object 创建后无法同 Wwise 工程保存，如果想复现 Soundcaster Session 功能，需要将每组 Session 的 GUID 单独保存以供下次重建 Transport Object。</p>
<h4 id="选定-API-2"><a href="#选定-API-2" class="headerlink" title="选定 API"></a>选定 API</h4><ul>
<li>走带条控制：<code>transport</code></li>
</ul>
<h4 id="编写代码-2"><a href="#编写代码-2" class="headerlink" title="编写代码"></a>编写代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 为对象创建 Transport Object（X 为自定编号或标记，以下简称为走带条对象），创建结束后会返回走带条对象的 GUID。为方便管理，我们把对象名跟走带条对象的 GUID 放在同一个字典里作为函数返回值</span></span><br><span class="line"><span class="keyword">from</span> waapi <span class="keyword">import</span> WaapiClient, CannotConnectToWaapiException</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">transportX</span><span class="params">(object_guid)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> WaapiClient() <span class="keyword">as</span> client:</span><br><span class="line">            <span class="comment"># 设置查询参数为走带条可控对象的 GUID</span></span><br><span class="line">            transport_args = &#123;</span><br><span class="line">                <span class="string">"object"</span>: object_guid</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 返回值为字典格式的走带条对象 ID，如 &#123;'transport': 12&#125; </span></span><br><span class="line">            result_transport_id = client.call(<span class="string">"ak.wwise.core.transport.create"</span>, transport_args)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 通过 object_guid 设置条件，通过 `ak.wwise.core.object.get` 获取对象名字。当然，你如果在上面直接传入对象名字来创建走带条对象，也可省略此步</span></span><br><span class="line">            args = &#123;</span><br><span class="line">                <span class="string">"from"</span>: &#123;</span><br><span class="line">                    <span class="string">"id"</span>: [</span><br><span class="line">                        object_guid</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            opts = &#123;</span><br><span class="line">                <span class="string">"return"</span>: [</span><br><span class="line">                    <span class="string">"name"</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 进行远程调用，得到返回值为字典格式的对象名称，如 &#123;'name': 'MyObjectName'&#125;</span></span><br><span class="line">            result_dict_name = client.call(<span class="string">"ak.wwise.core.object.get"</span>, args, options=opts)[<span class="string">'return'</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 合并对象名称和走带条对象 ID 这两个字典，从而获得 &#123;'name': 'MyObjectName', 'transport': 1234&#125; 这种字典结构的走带条 Session</span></span><br><span class="line">            <span class="keyword">return</span> result_dict_name.update(result_transport_id)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> CannotConnectToWaapiException:</span><br><span class="line">        print(<span class="string">"Could not connect to Waapi: Is Wwise running and Wwise Authoring API enabled?"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在获取了多个 Transport Object 的“字典+走带条 ID“格式的数据后，可将其放入一个列表中作为储存，这种结构就已经是一个初级的 Soundcaster Session 了，例如：</span></span><br><span class="line"><span class="comment"># env_session = [&#123;'name': 'MyObjectName1', 'transport': 1234&#125;, &#123;'name': 'MyObjectName2', 'transport': 12345&#125;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 从 Transport Session 中获取需要被控制的走带条的 Transport ID 字典</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_transport_args</span><span class="params">(env_session, object_name, play_state)</span>:</span></span><br><span class="line">    <span class="comment"># 遍历储存走带条对象 Session 的列表 env_session，获取给定对象名 object_name 所对应的字典 transport_dict</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> env_session:</span><br><span class="line">        <span class="keyword">if</span> i[<span class="string">'name'</span>] == object_name:</span><br><span class="line">            transport_dict = i</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 从 transport_dict 中获取走带条对象的 ID 对应的字典，并且与播放行为字典进行合并，准备作为参数传递</span></span><br><span class="line">    transport_id = &#123;<span class="string">'transport'</span>: transport_dict[transport]&#125;</span><br><span class="line">    args = &#123;<span class="string">"action"</span>: play_state&#125;</span><br><span class="line">    <span class="keyword">return</span> args.update(transport_id)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 传入 Transport Session、Session 内需要播放的走带条对象、播放行为，通过第二步的函数获得参数，远程调用 executeAction 来控制走带条的播放行为</span></span><br><span class="line"><span class="keyword">from</span> waapi <span class="keyword">import</span> WaapiClient, CannotConnectToWaapiException</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> WaapiClient() <span class="keyword">as</span> client:</span><br><span class="line">        args = get_transport_args(env_session, object_name, play_state)</span><br><span class="line">        client.call(<span class="string">"ak.wwise.core.transport.executeAction"</span>, args)</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> CannotConnectToWaapiException:</span><br><span class="line">    print(<span class="string">"Could not connect to Waapi: Is Wwise running and Wwise Authoring API enabled?"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="4-抓取-Profiler-数据生成报告"><a href="#4-抓取-Profiler-数据生成报告" class="headerlink" title="4. 抓取 Profiler 数据生成报告"></a>4. 抓取 Profiler 数据生成报告</h3><h4 id="选定-API-3"><a href="#选定-API-3" class="headerlink" title="选定 API"></a>选定 API</h4><ul>
<li>开始连接：<code>startCapture, stopCapture</code></li>
<li>抓取信息：<code>getBusses, getCursorTime, getRTPCs, getVoiceContributions, getVoices</code></li>
</ul>
<h4 id="编写代码-3"><a href="#编写代码-3" class="headerlink" title="编写代码"></a>编写代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 开始 Profiler 数据抓取，并返回抓取开始时的时间</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_capture</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> client.call(<span class="string">"ak.wwise.core.profiler.startCapture"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 结束抓取，并返回抓取结束时的时间</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stop_capture</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> client.call(<span class="string">"ak.wwise.core.profiler.startCapture"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 从抓取到的数据中获取各种信息，注意 cursor_time 的取值范围需要在 tart_capture() 和 stop_capture() 之间</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">capture_log_query</span><span class="params">(cursor_time)</span>:</span></span><br><span class="line">    <span class="comment"># 设定要查询的时间点</span></span><br><span class="line">    args_times = &#123;</span><br><span class="line">        <span class="string">"time"</span>: cursor_time</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取当前时间点上的声部名称、是否为虚声部、与其相关的 Game Object 名称与 ID</span></span><br><span class="line">    opts_get_voices = &#123;</span><br><span class="line">        <span class="string">"return"</span>: [</span><br><span class="line">            <span class="string">"objectName"</span>, <span class="string">"isVirtual"</span>, <span class="string">"gameObjectName"</span>, <span class="string">"gameObjectID"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 获取当前时间点上存在的 Bus</span></span><br><span class="line">    opts_get_busses = &#123;</span><br><span class="line">        <span class="string">"return"</span>: [</span><br><span class="line">            <span class="string">"objectName"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回当前活跃 RTPC ID 与值</span></span><br><span class="line">    log_rtpcs = client.call(<span class="string">"ak.wwise.core.profiler.getRTPCs"</span>, args_times)[<span class="string">"return"</span>]</span><br><span class="line">    <span class="comment"># 功能见上方相关函数的注释</span></span><br><span class="line">    log_voices = client.call(<span class="string">"ak.wwise.core.profiler.getVoices"</span>, args_times, options=opts_get_voices)[<span class="string">"return"</span>]</span><br><span class="line">    log_busses = client.call(<span class="string">"ak.wwise.core.profiler.getBusses"</span>, args_times, options=opts_get_busses)[<span class="string">"return"</span>]</span><br></pre></td></tr></table></figure>
<h2 id="接下来讲什么？"><a href="#接下来讲什么？" class="headerlink" title="接下来讲什么？"></a>接下来讲什么？</h2><p>下一篇文章中，我们会讨论执行类中剩下的模块，包括 UI 操作模块 <code>wwise.ui</code>、WAAPI 模块 <code>wwise.waapi</code>、Debug 模块 <code>wwise.debug</code>及声音引擎模块 <code>soundengine</code>。</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">溪夜</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://xiye.art/2020/09/05/WAAPI 一文通（二）/">http://xiye.art/2020/09/05/WAAPI 一文通（二）/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://xiye.art" target="_blank">溪夜的音频博客</a>！</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/09/20/如何使用 ReaScript 进一步改善 Reaper 效率？（一）/"><i class="fa fa-chevron-left">  </i><span>补完 Reaper 效率链的最后一环（一）ReaScript 基础</span></a></div><div class="next-post pull-right"><a href="/2020/09/03/本号须知/"><span>必看须知</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="lv-container" data-id="city" data-uid="MTAyMC80MDk4Ny8xNzUxMg=="><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
})(document, 'script');</script></div></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2020 By 溪夜</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script><script src="/js/search/local-search.js"></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>